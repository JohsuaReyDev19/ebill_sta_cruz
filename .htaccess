RewriteEngine On

# -----------------------------------------
# 1. Redirect .php → clean URL (pages only)
# -----------------------------------------
RewriteCond %{THE_REQUEST} \s(.+?)\.php[\s?]
RewriteCond %{REQUEST_URI} !/action/
RewriteRule ^ %1 [R=301,L]

# -----------------------------------------
# 2. Internally rewrite clean URL → .php
#    (exclude ALL /action/ folders)
# -----------------------------------------
RewriteCond %{REQUEST_URI} !/action/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)$ $1.php [L,QSA]

# -----------------------------------------
# 3. Security hardening
# -----------------------------------------
<FilesMatch "\.(env|ini|log|sql|bak)$">
    Require all denied
</FilesMatch>

Options -Indexes
